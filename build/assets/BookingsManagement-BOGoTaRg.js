import{j as e}from"./radix-vendor-BV-zUPZ_.js";import{a as p}from"./react-vendor-BK8AH302.js";import{j as i,f as J,d as I}from"./index-BcnowT96.js";import{bI as $,ak as k,bB as T,am as D,b4 as A,av as S,bo as _,au as R,b0 as B,at as M,aS as E,bJ as O,bh as F}from"./ui-vendor-qxZeYYxY.js";class L{getDriverProfile(t){return i.driverProfiles.get(t)}getAllDriverProfiles(){return Array.from(i.driverProfiles.values())}getAllPartners(){return Array.from(i.driverProfiles.values()).filter(t=>t.isPartner)}getSubDrivers(t){const r=i.driverProfiles.get(t);return!r||!r.isPartner||!r.subDrivers?[]:r.subDrivers.map(s=>i.driverProfiles.get(s)).filter(s=>s!==void 0)}addSubDriver(t,r){const s=i.driverProfiles.get(t);if(!s||!s.isPartner)return null;const a=`DRV${Date.now()}`,d={...r,id:a,partnerId:t,partnerName:s.name,joinedDate:new Date().toISOString(),isPartner:!1};return i.driverProfiles.set(a,d),s.subDrivers||(s.subDrivers=[]),s.subDrivers.push(a),i.driverProfiles.set(t,s),i.emit("sub_driver_added",{partner:s,subDriver:d}),d}removeSubDriver(t,r){const s=i.driverProfiles.get(t);return!s||!s.isPartner||!s.subDrivers?!1:(s.subDrivers=s.subDrivers.filter(a=>a!==r),i.driverProfiles.set(t,s),i.driverProfiles.delete(r),i.emit("sub_driver_removed",{partnerId:t,subDriverId:r}),!0)}assignJobToSubDriver(t,r,s){const a=i.driverProfiles.get(r),d=i.driverProfiles.get(s);if(!a||!d||d.partnerId!==r)return!1;const o=i.jobs.get(t);return o?(o.driverId=s,o.driverName=d.name,o.driverUsername=d.username,o.driverPhone=d.phone,o.status="assigned",o.assignedAt=new Date().toISOString(),i.jobs.set(t,o),i.emit("job_assigned_to_sub_driver",{job:o,partner:a,subDriver:d}),i.addNotification(s,{id:`notif_${Date.now()}`,type:"job_assigned",title:"New Job from Partner",message:`${a.name} assigned you: ${o.title}`,timestamp:new Date().toISOString(),read:!1,jobId:o.id}),!0):!1}getPartnerJobs(t){const r=i.driverProfiles.get(t);return!r||!r.isPartner||!r.subDrivers?[]:i.getAllJobs().filter(s=>s.driverId&&r.subDrivers?.includes(s.driverId))}calculatePartnerEarnings(t){const r=i.driverProfiles.get(t);if(!r||!r.isPartner||!r.subDrivers)return{totalEarnings:0,totalJobs:0,subDriverBreakdown:[]};const s=r.partnerRevenueSplit||15;let a=0,d=0;const o=[];return r.subDrivers.forEach(u=>{const m=i.driverProfiles.get(u);if(!m)return;const l=i.getDriverJobs(u).filter(x=>x.status==="completed"),c=l.reduce((x,f)=>x+f.driverPrice,0),b=c*(s/100);a+=b,d+=l.length,o.push({driverId:u,driverName:m.name,earnings:c,partnerCut:b,jobs:l.length})}),{totalEarnings:a,totalJobs:d,subDriverBreakdown:o}}updateDriverAvailability(t,r){const s=i.driverProfiles.get(t);return s?(s.isAvailable=r,i.driverProfiles.set(t,s),i.emit("driver_availability_changed",{driverId:t,isAvailable:r}),!0):!1}setAvailabilitySchedule(t,r){const s=i.driverProfiles.get(t);return s?(s.availabilitySchedule=r,i.driverProfiles.set(t,s),i.emit("availability_schedule_updated",{driverId:t,schedule:r}),!0):!1}addUnavailableDate(t,r){const s=i.driverProfiles.get(t);return s?(s.unavailableDates||(s.unavailableDates=[]),s.unavailableDates.includes(r)||s.unavailableDates.push(r),i.driverProfiles.set(t,s),!0):!1}removeUnavailableDate(t,r){const s=i.driverProfiles.get(t);return!s||!s.unavailableDates?!1:(s.unavailableDates=s.unavailableDates.filter(a=>a!==r),i.driverProfiles.set(t,s),!0)}isDriverAvailable(t,r){const s=i.driverProfiles.get(t);return!(!s||!s.isAvailable||s.unavailableDates?.includes(r))}getAvailableDriversForJob(t,r){return Array.from(i.driverProfiles.values()).filter(s=>!(!s.isAvailable||s.unavailableDates?.includes(t)||r&&s.vehicleType!==r))}updateBankAccount(t,r){const s=i.driverProfiles.get(t);return s?(s.bankAccount=r,i.driverProfiles.set(t,s),i.emit("bank_account_updated",{driverId:t,bankAccount:r}),!0):!1}verifyBankAccount(t){const r=i.driverProfiles.get(t);return!r||!r.bankAccount?!1:(r.bankAccount.verified=!0,r.bankAccount.verifiedAt=new Date().toISOString(),i.driverProfiles.set(t,r),i.addNotification(t,{id:`notif_${Date.now()}`,type:"message",title:"‚úÖ Bank Account Verified",message:"Your bank account has been verified. You can now receive payouts.",timestamp:new Date().toISOString(),read:!1}),!0)}updateInsurance(t,r){const s=i.driverProfiles.get(t);return s?(s.insurance=r,i.driverProfiles.set(t,s),i.emit("insurance_updated",{driverId:t,insurance:r}),!0):!1}verifyInsurance(t,r){const s=i.driverProfiles.get(t);return!s||!s.insurance?!1:(s.insurance.verified=!0,s.insurance.verifiedBy=r,s.insurance.verifiedAt=new Date().toISOString(),i.driverProfiles.set(t,s),i.addNotification(t,{id:`notif_${Date.now()}`,type:"message",title:"‚úÖ Insurance Verified",message:"Your insurance has been verified by admin.",timestamp:new Date().toISOString(),read:!1}),!0)}getDriversWithExpiringInsurance(t=30){const r=new Date,s=new Date(r.getTime()+t*24*60*60*1e3);return Array.from(i.driverProfiles.values()).filter(a=>a.insurance?new Date(a.insurance.expiryDate)<=s:!1)}updateNotificationPreferences(t,r){const s=i.driverProfiles.get(t);return s?(s.notificationPreferences=r,i.driverProfiles.set(t,s),i.emit("notification_preferences_updated",{driverId:t,preferences:r}),!0):!1}}const j=new L;class V{payments=new Map;payouts=new Map;invoices=new Map;nextInvoiceNumber=1;cancellationPolicies=[{timeBeforeJob:24,refundPercentage:100,driverCompensationPercentage:0},{timeBeforeJob:12,refundPercentage:50,driverCompensationPercentage:25},{timeBeforeJob:0,refundPercentage:0,driverCompensationPercentage:50}];createPayment(t,r,s="card"){let a=0;r==="deposit"||r==="final"?a=t.customerPrice*.5:a=t.customerPrice;const d=j.getDriverProfile(t.driverId||"");let o=0,u=a;if(d?.isVATRegistered){const l=i.getExtraPricingConfig().vatRate/100;o=a*l,u=a+o}const m={id:`PAY${Date.now()}`,jobId:t.id,jobReference:t.reference,customerId:t.customerId||"",customerName:t.customerName,type:r,amount:a,vatAmount:d?.isVATRegistered?o:void 0,totalAmount:u,status:"pending",paymentMethod:s,createdAt:new Date().toISOString()};return this.payments.set(m.id,m),m}async processStripePayment(t,r){const s=this.payments.get(t);if(!s)return!1;try{return s.status="processing",s.stripePaymentIntentId=`pi_${Date.now()}`,s.metadata={cardLast4:"4242",cardBrand:"Visa"},setTimeout(()=>{s.status="completed",s.completedAt=new Date().toISOString(),this.payments.set(t,s);const a=i.getJob(s.jobId);a&&this.generateInvoice(a),a&&J.sendJobNotification(a,"payment_received")},1e3),this.payments.set(t,s),!0}catch{return s.status="failed",this.payments.set(t,s),!1}}refundPayment(t,r,s){const a=this.payments.get(t);return!a||a.status!=="completed"?!1:(a.refundAmount=r,a.refundReason=s,a.refundedAt=new Date().toISOString(),a.status="refunded",this.payments.set(t,a),i.addNotification(a.customerId,{id:`notif_${Date.now()}`,type:"payment",title:"Refund Processed",message:`Refund of ¬£${r.toFixed(2)} processed for ${a.jobReference}. ${s}`,timestamp:new Date().toISOString(),read:!1,jobId:a.jobId}),!0)}getJobPayments(t){return Array.from(this.payments.values()).filter(r=>r.jobId===t)}getCustomerPayments(t){return Array.from(this.payments.values()).filter(r=>r.customerId===t)}schedulePayout(t,r,s){const a=j.getDriverProfile(t);if(!a)throw new Error("Driver not found");let d=0;r.forEach(u=>{const m=i.getJob(u);if(m&&m.status==="completed"&&(d+=m.driverPrice,a.partnerId)){const c=(j.getDriverProfile(a.partnerId)?.partnerRevenueSplit||15)/100;d-=m.driverPrice*c}});const o={id:`PAYOUT${Date.now()}`,driverId:t,driverName:a.name,amount:d,jobs:r,status:"pending",scheduledFor:s,bankAccount:a.bankAccount?{accountNumber:a.bankAccount.accountNumber,sortCode:a.bankAccount.sortCode}:void 0};return this.payouts.set(o.id,o),i.addNotification(t,{id:`notif_${Date.now()}`,type:"payment",title:"Payout Scheduled",message:`Payout of ¬£${d.toFixed(2)} scheduled for ${new Date(s).toLocaleDateString()}`,timestamp:new Date().toISOString(),read:!1}),o}processPayout(t){const r=this.payouts.get(t);return r?(r.status="processing",this.payouts.set(t,r),setTimeout(()=>{r.status="completed",r.completedAt=new Date().toISOString(),this.payouts.set(t,r),i.addNotification(r.driverId,{id:`notif_${Date.now()}`,type:"payment",title:"üí∞ Payout Completed",message:`¬£${r.amount.toFixed(2)} has been transferred to your bank account`,timestamp:new Date().toISOString(),read:!1})},2e3),!0):!1}getDriverPayouts(t){return Array.from(this.payouts.values()).filter(r=>r.driverId===t)}getPendingPayouts(){return Array.from(this.payouts.values()).filter(t=>t.status==="pending")}generateInvoice(t){const r=j.getDriverProfile(t.driverId||""),s=r?.isVATRegistered||!1,a=i.getExtraPricingConfig().vatRate/100,d=[];d.push({description:`${t.service} - ${t.title}`,quantity:1,unitPrice:t.originalCustomerPrice||t.customerPrice,totalPrice:t.originalCustomerPrice||t.customerPrice}),t.extraItems&&t.extraItems.length>0&&t.extraItems.forEach(g=>{d.push({description:`Extra: ${g.name}`,quantity:g.quantity,unitPrice:(t.extraItemsCustomerCharge||0)/t.extraItems.length,totalPrice:(t.extraItemsCustomerCharge||0)/t.extraItems.length})});const o=t.originalCustomerPrice||t.customerPrice,u=s?o*a:void 0,m=s?o+(u||0):o,l=t.extraItemsCustomerCharge||0,c=s&&l>0?l*a:void 0,b=s&&l>0?l+(c||0):l,x=o+l,f=s?x*a:void 0,N=s?x+(f||0):x,y=String(this.nextInvoiceNumber).padStart(6,"0");this.nextInvoiceNumber++;const n={id:`INV${Date.now()}`,invoiceNumber:`INV-${y}`,jobId:t.id,jobReference:t.reference,customerId:t.customerId||"",customerName:t.customerName,driverId:t.driverId,driverName:t.driverName,driverVATNumber:r?.vatNumber,isVATInvoice:s,items:d,originalSubtotal:o,originalVAT:u,originalTotal:m,extraItemsSubtotal:l>0?l:void 0,extraItemsVAT:c,extraItemsTotal:b>0?b:void 0,subtotal:x,vatAmount:f,total:N,issueDate:new Date().toISOString(),dueDate:new Date(Date.now()+720*60*60*1e3).toISOString(),status:"issued",sentToCustomer:!1,createdAt:new Date().toISOString()};return this.invoices.set(n.id,n),n}markInvoicePaid(t){const r=this.invoices.get(t);return r?(r.status="paid",r.paidDate=new Date().toISOString(),this.invoices.set(t,r),!0):!1}getJobInvoice(t){return Array.from(this.invoices.values()).find(r=>r.jobId===t)}getCustomerInvoices(t){return Array.from(this.invoices.values()).filter(r=>r.customerId===t)}getDriverInvoices(t){return Array.from(this.invoices.values()).filter(r=>r.driverId===t)}cancelJob(t,r){const s=i.getJob(t);if(!s)return{success:!1,refundAmount:0,driverCompensation:0,message:"Job not found"};const d=(new Date(s.date).getTime()-Date.now())/(1e3*60*60),o=this.cancellationPolicies.find(c=>d>=c.timeBeforeJob)||this.cancellationPolicies[this.cancellationPolicies.length-1],u=s.customerPrice*(o.refundPercentage/100),m=s.driverPrice*(o.driverCompensationPercentage/100);return this.getJobPayments(t).forEach(c=>{c.status==="completed"&&this.refundPayment(c.id,u,r)}),i.updateJobStatus(t,"cancelled"),m>0&&s.driverId&&i.addNotification(s.driverId,{id:`notif_${Date.now()}`,type:"payment",title:"Cancellation Compensation",message:`You received ¬£${m.toFixed(2)} for cancelled job ${s.reference}`,timestamp:new Date().toISOString(),read:!1,jobId:s.id}),{success:!0,refundAmount:u,driverCompensation:m,message:`Job cancelled. ${o.refundPercentage}% refunded (¬£${u.toFixed(2)}). Driver compensated ¬£${m.toFixed(2)}.`}}getCancellationPolicy(t){const r=i.getJob(t);if(!r)return null;const a=(new Date(r.date).getTime()-Date.now())/(1e3*60*60);return this.cancellationPolicies.find(d=>a>=d.timeBeforeJob)||this.cancellationPolicies[this.cancellationPolicies.length-1]}getRevenueReport(t,r){const s=Array.from(this.payments.values()).filter(l=>{const c=new Date(l.createdAt);return c>=new Date(t)&&c<=new Date(r)&&l.status==="completed"}),a=s.reduce((l,c)=>l+c.totalAmount,0),d=s.reduce((l,c)=>l+(c.refundAmount||0),0),o=i.getAllJobs().filter(l=>{const c=new Date(l.createdAt||"");return c>=new Date(t)&&c<=new Date(r)&&l.status==="completed"}),u=o.reduce((l,c)=>l+c.platformFee,0),m=o.reduce((l,c)=>l+c.driverPrice,0);return{totalRevenue:a,totalPayments:s.length,totalRefunds:d,platformFees:u,driverPayouts:m,netRevenue:u-d}}getDriverEarningsReport(t,r,s){const a=i.getDriverJobs(t).filter(l=>{const c=new Date(l.completedAt||"");return c>=new Date(r)&&c<=new Date(s)&&l.status==="completed"}),d=a.reduce((l,c)=>l+c.driverPrice,0),o=this.getDriverPayouts(t),u=o.filter(l=>l.status==="pending").reduce((l,c)=>l+c.amount,0),m=o.filter(l=>l.status==="completed").reduce((l,c)=>l+c.amount,0);return{totalEarnings:d,totalJobs:a.length,averageJobValue:a.length>0?d/a.length:0,pendingPayouts:u,completedPayouts:m}}getAllPayments(){return Array.from(this.payments.values()).sort((t,r)=>new Date(r.createdAt).getTime()-new Date(t.createdAt).getTime())}getAllInvoices(){return Array.from(this.invoices.values()).sort((t,r)=>new Date(r.issueDate).getTime()-new Date(t.issueDate).getTime())}getAllPayouts(){return Array.from(this.payouts.values()).sort((t,r)=>new Date(r.scheduledFor).getTime()-new Date(t.scheduledFor).getTime())}}const U=new V;function q(){const[h,t]=p.useState(""),[r,s]=p.useState("all"),[a,d]=p.useState(null),[o,u]=p.useState(!1),[m,l]=p.useState([]),{addJobToJourney:c,isJobInJourney:b}=I();p.useEffect(()=>{const n=()=>{const C=i.getAllJobs();l(C)};n();const g=()=>{console.log("üì• Admin Panel: New job created!"),n()},v=()=>{console.log("‚úÖ Admin Panel: Job accepted by driver!"),n()},w=()=>{console.log("üîÑ Admin Panel: Job status changed!"),n()},P=()=>{console.log("üë§ Admin Panel: Job assigned to driver!"),n()};return i.on("job_created",g),i.on("job_accepted",v),i.on("job_status_changed",w),i.on("job_assigned",P),()=>{i.off("job_created",g),i.off("job_accepted",v),i.off("job_status_changed",w),i.off("job_assigned",P)}},[]);const[x]=p.useState([{id:"1",bookingNumber:"SMH-1001",customer:{name:"John Smith",email:"john@example.com",phone:"07700 900123"},service:"House Move",pickup:"London SW1A 1AA",delivery:"Manchester M1 1AE",date:"2024-12-20",time:"09:00",status:"pending",price:450,distance:215},{id:"2",bookingNumber:"SMH-1002",customer:{name:"Emma Wilson",email:"emma@example.com",phone:"07700 900456"},service:"Furniture Delivery",pickup:"Birmingham B1 1AA",delivery:"Leeds LS1 1AA",date:"2024-12-18",time:"14:00",status:"assigned",driver:"Mike Johnson",price:280,distance:120},{id:"3",bookingNumber:"SMH-1003",customer:{name:"David Brown",email:"david@example.com",phone:"07700 900789"},service:"Clearance & Removal",pickup:"Liverpool L1 1AA",delivery:"Liverpool L8 5XX",date:"2024-12-17",time:"10:30",status:"in-progress",driver:"Sarah Davis",price:120,distance:8},{id:"4",bookingNumber:"SMH-1004",customer:{name:"Lisa Anderson",email:"lisa@example.com",phone:"07700 900321"},service:"Office Move",pickup:"Bristol BS1 1AA",delivery:"Cardiff CF10 1AA",date:"2024-12-15",time:"08:00",status:"completed",driver:"Tom Wilson",price:650,distance:45},{id:"5",bookingNumber:"SMH-1005",customer:{name:"Mark Taylor",email:"mark@example.com",phone:"07700 900654"},service:"Student Move",pickup:"Oxford OX1 1AA",delivery:"Reading RG1 1AA",date:"2024-12-22",time:"11:00",status:"pending",price:185,distance:40}]),f={pending:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-300",label:"Pending"},assigned:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-300",label:"Assigned"},"in-progress":{bg:"bg-purple-100",text:"text-purple-700",border:"border-purple-300",label:"In Progress"},completed:{bg:"bg-green-100",text:"text-green-700",border:"border-green-300",label:"Completed"},cancelled:{bg:"bg-red-100",text:"text-red-700",border:"border-red-300",label:"Cancelled"}},N=x.filter(n=>{const g=n.bookingNumber.toLowerCase().includes(h.toLowerCase())||n.customer.name.toLowerCase().includes(h.toLowerCase()),v=r==="all"||n.status===r;return g&&v}),y={all:x.length,pending:x.filter(n=>n.status==="pending").length,assigned:x.filter(n=>n.status==="assigned").length,"in-progress":x.filter(n=>n.status==="in-progress").length,completed:x.filter(n=>n.status==="completed").length,cancelled:x.filter(n=>n.status==="cancelled").length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-slate-900",children:"Bookings Management"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Manage all customer bookings and assignments"})]}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:shadow-lg transition-all",children:[e.jsx($,{className:"w-5 h-5"}),"Export Data"]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:Object.entries(y).map(([n,g])=>e.jsxs("button",{onClick:()=>s(n),className:`p-4 rounded-xl border-2 transition-all ${r===n?"border-blue-500 bg-blue-50 shadow-lg":"border-slate-200 bg-white hover:border-blue-300"}`,children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:g}),e.jsx("div",{className:"text-xs text-slate-600 mt-1 capitalize",children:n==="all"?"All Bookings":n.replace("-"," ")})]},n))}),e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-slate-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(k,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search by booking number or customer name...",value:h,onChange:n=>t(n.target.value),className:"w-full pl-12 pr-4 py-3 rounded-xl border border-slate-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]}),e.jsxs("button",{className:"flex items-center gap-2 px-6 py-3 bg-slate-100 hover:bg-slate-200 rounded-xl transition-all",children:[e.jsx(T,{className:"w-5 h-5"}),"More Filters"]})]})}),e.jsxs("div",{className:"space-y-3",children:[N.map(n=>e.jsxs("div",{className:"bg-white rounded-xl shadow-md border-2 border-slate-300 hover:border-slate-400 hover:shadow-xl transition-all overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-100 to-slate-200 px-5 py-3 border-b-2 border-slate-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-slate-700"}),e.jsx("span",{className:"font-black text-slate-900 text-base",children:n.bookingNumber})]}),e.jsx("span",{className:`px-3 py-1 rounded-md text-xs font-bold border-2 ${f[n.status].bg} ${f[n.status].text} ${f[n.status].border}`,children:f[n.status].label})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-600 font-semibold",children:"REVENUE"}),e.jsxs("div",{className:"text-xl font-black text-slate-900",children:["¬£",n.price]})]}),e.jsx("button",{onClick:()=>{d(n),u(!0)},className:"p-2 hover:bg-slate-300 rounded-lg transition-colors",children:e.jsx(A,{className:"w-5 h-5 text-slate-700"})})]})]})}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-slate-500 font-bold uppercase tracking-wide mb-2",children:"üë§ Customer"}),e.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-200",children:[e.jsx("div",{className:"font-bold text-slate-900",children:n.customer.name}),e.jsxs("div",{className:"text-sm text-slate-600 mt-1 flex items-center gap-2",children:[e.jsx(S,{className:"w-3 h-3"}),n.customer.phone]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-slate-500 font-bold uppercase tracking-wide mb-2",children:"üöö Driver"}),e.jsx("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-200",children:n.driver?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-600 to-indigo-600 flex items-center justify-center text-white font-bold text-sm",children:n.driver.charAt(0)}),e.jsx("div",{className:"font-bold text-slate-900",children:n.driver})]}):e.jsx("div",{className:"text-sm text-orange-600 font-semibold",children:"‚ö†Ô∏è Not Assigned"})})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-slate-100 p-4 rounded-lg border-2 border-slate-200 mb-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-blue-600"}),e.jsx("div",{className:"w-0.5 h-8 bg-slate-400"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-red-600"})]}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-blue-700 font-bold uppercase",children:"From"}),e.jsx("div",{className:"font-bold text-slate-900",children:n.pickup})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-red-700 font-bold uppercase",children:"To"}),e.jsx("div",{className:"font-bold text-slate-900",children:n.delivery})]})]}),e.jsxs("div",{className:"text-right bg-white px-3 py-2 rounded-lg border border-slate-300",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Distance"}),e.jsxs("div",{className:"font-black text-slate-900",children:[n.distance,"mi"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"text-xs text-blue-700 font-semibold mb-1",children:"üìÖ Date"}),e.jsx("div",{className:"font-bold text-slate-900 text-sm",children:n.date})]}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg border border-purple-200",children:[e.jsx("div",{className:"text-xs text-purple-700 font-semibold mb-1",children:"‚è∞ Time"}),e.jsx("div",{className:"font-bold text-slate-900 text-sm",children:n.time})]}),e.jsxs("div",{className:"bg-indigo-50 p-3 rounded-lg border border-indigo-200",children:[e.jsx("div",{className:"text-xs text-indigo-700 font-semibold mb-1",children:"üì¶ Service"}),e.jsx("div",{className:"font-bold text-slate-900 text-xs truncate",children:n.service})]})]}),e.jsxs("div",{className:"flex gap-2 pt-3 border-t border-slate-200",children:[e.jsxs("button",{onClick:()=>{c(n.id)},disabled:b(n.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg font-semibold text-sm transition-all ${b(n.id)?"bg-green-100 text-green-700 border-2 border-green-300 cursor-not-allowed":"bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:shadow-lg hover:scale-105"}`,children:[e.jsx(_,{className:"w-4 h-4"}),b(n.id)?"‚úì In Journey":"Add to Journey"]}),e.jsxs("button",{className:"px-4 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg font-semibold text-sm transition-all flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"View"]})]})]})]},n.id)),N.length===0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border-2 border-slate-200 p-12 text-center",children:[e.jsx(D,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-slate-700 mb-2",children:"No bookings found"}),e.jsx("p",{className:"text-slate-500",children:"Try adjusting your search or filters"})]})]}),o&&a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:"Booking Details"}),e.jsx("button",{onClick:()=>u(!1),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:"‚úï"})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-xl",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600",children:"Booking Number"}),e.jsx("p",{className:"text-xl font-bold text-slate-900",children:a.bookingNumber})]}),e.jsx("span",{className:`px-4 py-2 rounded-full font-medium ${f[a.status].bg} ${f[a.status].text}`,children:f[a.status].label})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-bold text-slate-900",children:"Customer Information"}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg",children:[e.jsx(R,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-600",children:"Name"}),e.jsx("p",{className:"font-medium text-slate-900",children:a.customer.name})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg",children:[e.jsx(S,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-600",children:"Phone"}),e.jsx("p",{className:"font-medium text-slate-900",children:a.customer.phone})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg sm:col-span-2",children:[e.jsx(B,{className:"w-5 h-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-600",children:"Email"}),e.jsx("p",{className:"font-medium text-slate-900",children:a.customer.email})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-bold text-slate-900",children:"Service Details"}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-slate-600",children:"Service Type"}),e.jsx("p",{className:"font-medium text-slate-900",children:a.service})]}),e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-slate-600",children:"Distance"}),e.jsxs("p",{className:"font-medium text-slate-900",children:[a.distance," miles"]})]}),e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-slate-600",children:"Date"}),e.jsx("p",{className:"font-medium text-slate-900",children:a.date})]}),e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-slate-600",children:"Time"}),e.jsx("p",{className:"font-medium text-slate-900",children:a.time})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-bold text-slate-900",children:"Route"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center font-bold text-sm",children:"A"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-600",children:"Pickup Location"}),e.jsx("p",{className:"font-medium text-slate-900",children:a.pickup})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-600 text-white flex items-center justify-center font-bold text-sm",children:"B"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-600",children:"Delivery Location"}),e.jsx("p",{className:"font-medium text-slate-900",children:a.delivery})]})]})]})]}),a.driver&&e.jsx("div",{className:"p-4 bg-purple-50 rounded-xl border border-purple-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(M,{className:"w-5 h-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-600",children:"Assigned Driver"}),e.jsx("p",{className:"font-bold text-slate-900",children:a.driver})]})]})}),e.jsx("div",{className:"p-4 bg-green-50 rounded-xl border border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(E,{className:"w-5 h-5 text-green-600"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Total Price"})]}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["¬£",a.price]})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-medium transition-all",children:"Assign Driver"}),e.jsx("button",{className:"flex-1 px-4 py-3 bg-green-600 hover:bg-green-700 text-white rounded-xl font-medium transition-all",children:"Mark Completed"})]}),a.status!=="cancelled"&&a.status!=="completed"&&e.jsxs("div",{className:"border-t border-slate-200 pt-4",children:[e.jsxs("button",{onClick:()=>{const n=`JOB-${a.bookingNumber}`,g=prompt("Enter cancellation reason:");if(g){const v=U.cancelJob(n,g);v.success?(alert(`‚úÖ ${v.message}

üí∞ Customer Refund: ¬£${v.refundAmount.toFixed(2)}
üíµ Driver Compensation: ¬£${v.driverCompensation.toFixed(2)}`),u(!1)):alert(`‚ùå ${v.message}`)}},className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-red-50 hover:bg-red-100 text-red-600 rounded-xl font-medium transition-all border-2 border-red-200 hover:border-red-300",children:[e.jsx(O,{className:"w-5 h-5"}),"Cancel Job & Process Refund"]}),e.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(F,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-xs text-yellow-800",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Cancellation Policy:"}),e.jsxs("ul",{className:"space-y-0.5 text-yellow-700",children:[e.jsx("li",{children:"‚Ä¢ 24+ hours before: 100% refund to customer"}),e.jsx("li",{children:"‚Ä¢ 12-24 hours: 50% refund, 25% to driver"}),e.jsx("li",{children:"‚Ä¢ Less than 12 hours: No refund, 50% to driver"})]})]})]})})]}),(a.status==="cancelled"||a.status==="completed")&&e.jsx("div",{className:`p-4 rounded-xl border-2 ${a.status==="cancelled"?"bg-red-50 border-red-200":"bg-green-50 border-green-200"}`,children:e.jsx("p",{className:`text-sm font-medium ${a.status==="cancelled"?"text-red-700":"text-green-700"}`,children:a.status==="cancelled"?"‚ùå This booking has been cancelled and refund has been processed.":"‚úÖ This booking has been completed successfully."})})]})]})})]})}export{q as BookingsManagement};
