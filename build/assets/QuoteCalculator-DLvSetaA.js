import{r,j as e,P as I,L as F}from"./index-5UJQZh1O.js";import{P as T}from"./pricingEngine-Bip1o_TA.js";import{D as A}from"./download-Iv45di7Q.js";import{M as P}from"./minus-BSb6MesL.js";import{P as L}from"./plus-C_zTDATH.js";import{N as M}from"./navigation-DtiQYTGD.js";import{T as o}from"./badge-CFUPwwPp.js";import{T as q}from"./trending-up-Dos6uxXs.js";import{C as B}from"./App-CxomlPn2.js";import"./adminPricingManager-Fd3awkha.js";const R=[{id:"small",name:"Small Van",icon:e.jsx(o,{className:"w-5 h-5"}),minVolume:0,maxVolume:5},{id:"medium",name:"Medium Van",icon:e.jsx(o,{className:"w-6 h-6"}),minVolume:5,maxVolume:10},{id:"large",name:"Large Van",icon:e.jsx(o,{className:"w-7 h-7"}),minVolume:10,maxVolume:18},{id:"luton",name:"Luton Van",icon:e.jsx(o,{className:"w-8 h-8"}),minVolume:18,maxVolume:25}],Q=[{id:"assembly",name:"Assembly Service",price:30,type:"flat"},{id:"disassembly",name:"Disassembly Service",price:30,type:"flat"},{id:"packaging",name:"Packaging Materials",price:50,type:"flat"}],f=[{id:"11",name:"2-seat sofa",category:"Living Room",volume:1.22},{id:"12",name:"3-seat sofa",category:"Living Room",volume:1.84},{id:"34",name:"Double mattress",category:"Bedroom",volume:.61},{id:"38",name:"Double bed frame",category:"Bedroom",volume:1.02},{id:"48",name:"Wardrobe 2 doors",category:"Bedroom",volume:1.22},{id:"56",name:"Fridge freezer",category:"Kitchen",volume:1.02},{id:"59",name:"Washing machine",category:"Kitchen",volume:.61},{id:"70",name:"Dining table (6 seats)",category:"Dining",volume:1.22},{id:"2",name:"Medium box",category:"Boxes",volume:.05},{id:"3",name:"Large box",category:"Boxes",volume:.08}];function U(){const[i,m]=r.useState([]),[x,g]=r.useState(15),[u,N]=r.useState(2),[c,v]=r.useState({}),[h,y]=r.useState("auto"),[a,b]=r.useState(null),[w,p]=r.useState(!1),[d,k]=r.useState(0);r.useEffect(()=>{const s=i.reduce((l,t)=>{const n=f.find(D=>D.id===t.itemId);return l+(n?n.volume*t.quantity:0)},0);k(s)},[i]),r.useEffect(()=>{const l=setTimeout(async()=>{if(i.length===0){b(null);return}p(!0);let t=h;if(t==="auto"){const n=d*1.1;n<=5?t="small":n<=10?t="medium":n<=18?t="large":t="luton"}try{const n=await T.calculateQuote({serviceType:"house-move",pickup:{address:"Admin Entry",postcode:"ADMIN",floor:0,hasLift:!0},dropoff:{address:"Admin Entry",postcode:"ADMIN",floor:0,hasLift:!0},date:new Date,items:i,distance:x,selectedVehicle:t,extras:{assembly:!!c.assembly,disassembly:!!c.disassembly,packaging:!!c.packaging,helpers:u}});b(n)}catch(n){console.error(n)}finally{p(!1)}},500);return()=>clearTimeout(l)},[i,x,u,c,h,d]);const j=s=>{const l=i.find(t=>t.itemId===s);m(l?i.map(t=>t.itemId===s?{...t,quantity:t.quantity+1}:t):[...i,{itemId:s,quantity:1}])},V=s=>{const l=i.find(t=>t.itemId===s);l&&l.quantity>1?m(i.map(t=>t.itemId===s?{...t,quantity:t.quantity-1}:t)):m(i.filter(t=>t.itemId!==s))},S=s=>{v(l=>({...l,[s]:!l[s]}))},E=a?a.breakdown.total*.3:0,C=a?a.breakdown.total*.7:0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-slate-900",children:"Quote Calculator"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Admin tool for instant phone quotes"})]}),a&&e.jsxs("button",{onClick:()=>alert("Feature coming soon"),className:"flex items-center gap-2 px-6 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-xl hover:shadow-lg transition-all",children:[e.jsx(A,{className:"w-5 h-5"}),"Export PDF"]})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-slate-200",children:[e.jsxs("h3",{className:"font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5 text-blue-600"}),"Select Items"]}),e.jsx("div",{className:"grid sm:grid-cols-2 gap-3 max-h-96 overflow-y-auto",children:f.map(s=>{const l=i.find(t=>t.itemId===s.id);return e.jsx("div",{className:`p-3 rounded-xl border-2 transition-all ${l?"border-blue-500 bg-blue-50":"border-slate-200 bg-white hover:border-blue-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-slate-900 text-sm",children:s.name}),e.jsx("div",{className:"text-xs text-slate-500",children:s.category}),e.jsxs("div",{className:"text-xs font-bold text-blue-600 mt-1",children:[s.volume.toFixed(2)," m³"]})]}),l?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>V(s.id),className:"w-7 h-7 rounded-lg bg-red-100 text-red-600 hover:bg-red-200 flex items-center justify-center",children:e.jsx(P,{className:"w-4 h-4"})}),e.jsx("span",{className:"font-bold text-slate-900 w-6 text-center",children:l.quantity}),e.jsx("button",{onClick:()=>j(s.id),className:"w-7 h-7 rounded-lg bg-blue-100 text-blue-600 hover:bg-blue-200 flex items-center justify-center",children:e.jsx(L,{className:"w-4 h-4"})})]}):e.jsx("button",{onClick:()=>j(s.id),className:"px-3 py-1 bg-blue-600 text-white rounded-lg text-xs hover:bg-blue-700 transition-all",children:"Add"})]})},s.id)})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-slate-200",children:[e.jsxs("h3",{className:"font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5 text-purple-600"}),"Parameters"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Distance (miles)"}),e.jsx("input",{type:"number",value:x,onChange:s=>g(parseInt(s.target.value)||0),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-200 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Crew Size"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3].map(s=>e.jsxs("button",{onClick:()=>N(s),className:`flex-1 px-3 py-2 rounded-lg font-semibold text-sm transition-all ${u===s?"bg-blue-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:[s," Man"]},s))})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-slate-200",children:[e.jsxs("h3",{className:"font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(o,{className:"w-5 h-5 text-indigo-600"}),"Vehicle & Extras"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Vehicle Type"}),e.jsxs("select",{value:h,onChange:s=>y(s.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-200 outline-none",children:[e.jsx("option",{value:"auto",children:"Auto-select (Best Fit)"}),R.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsx("div",{className:"space-y-2",children:Q.map(s=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:!!c[s.id],onChange:()=>S(s.id),className:"w-4 h-4 text-blue-600 rounded"}),e.jsxs("span",{className:"text-sm text-slate-700",children:[s.name," (+£",s.price,")"]})]},s.id))})]})]})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx("div",{className:"sticky top-6",children:w&&!a?e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-12 flex items-center justify-center",children:e.jsx(F,{className:"w-8 h-8 animate-spin text-blue-600"})}):a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl shadow-lg p-6 border border-blue-200",children:[e.jsx("h3",{className:"font-bold text-slate-900 mb-4",children:"Volume Summary"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600",children:"Total Items Volume:"}),e.jsxs("span",{className:"font-bold text-slate-900",children:[d.toFixed(2)," m³"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600",children:"Safety Margin (+10%):"}),e.jsxs("span",{className:"font-bold text-blue-600",children:["+",(d*.1).toFixed(2)," m³"]})]}),e.jsx("div",{className:"pt-3 border-t border-blue-200",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:"Est. Volume:"}),e.jsxs("span",{className:"font-bold text-blue-600 text-lg",children:[(d*1.1).toFixed(2)," m³"]})]})})]})]}),e.jsxs("div",{className:"bg-slate-900 text-white rounded-2xl shadow-xl p-6",children:[e.jsx("div",{className:"text-slate-400 text-sm font-bold uppercase mb-1",children:"Estimated Price"}),e.jsxs("div",{className:"text-4xl font-extrabold flex items-center gap-1",children:[e.jsx("span",{className:"text-2xl text-slate-500",children:"£"}),a.breakdown.total.toFixed(2)]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-700 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Base Fare"}),e.jsxs("span",{children:["£",a.breakdown.basePrice.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-slate-400",children:["Distance (",x," mi)"]}),e.jsxs("span",{children:["£",a.breakdown.distancePrice.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Vehicle Surcharge"}),e.jsxs("span",{children:["£",a.breakdown.vehicleSurcharge.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Extras & Crew"}),e.jsxs("span",{children:["£",a.breakdown.extrasPrice.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"VAT (20%)"}),e.jsxs("span",{children:["£",a.breakdown.vat.toFixed(2)]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl shadow-lg p-6 border-2 border-purple-300",children:[e.jsxs("h3",{className:"font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5 text-purple-600"}),"Admin Insights"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600",children:"Platform Margin (30%):"}),e.jsxs("span",{className:"font-bold text-purple-600 text-lg",children:["£",E.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600",children:"Driver Earnings (70%):"}),e.jsxs("span",{className:"font-bold text-blue-600 text-lg",children:["£",C.toFixed(2)]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-slate-200",children:[e.jsx("h3",{className:"font-bold text-slate-900 mb-3",children:"Job Summary"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between p-2 bg-slate-50 rounded",children:[e.jsx("span",{className:"text-slate-600",children:"Vehicle"}),e.jsx("span",{className:"font-bold capitalize",children:a.recommendedVehicle})]}),e.jsxs("div",{className:"flex justify-between p-2 bg-slate-50 rounded",children:[e.jsx("span",{className:"text-slate-600",children:"Distance"}),e.jsxs("span",{className:"font-bold",children:[a.distance," miles"]})]}),e.jsxs("div",{className:"flex justify-between p-2 bg-slate-50 rounded",children:[e.jsx("span",{className:"text-slate-600",children:"Est. Duration"}),e.jsx("span",{className:"font-bold",children:a.estimatedDuration})]})]})]})]}):e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-12 border border-slate-200 text-center",children:[e.jsx(B,{className:"w-16 h-16 text-slate-200 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-500",children:"Add items to calculate price"})]})})})]})]})}export{U as QuoteCalculator};
