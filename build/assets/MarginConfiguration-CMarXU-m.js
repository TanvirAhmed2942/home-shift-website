import{j as e}from"./radix-vendor-BV-zUPZ_.js";import{a as i}from"./react-vendor-BK8AH302.js";import{E as N}from"./pricingEngine-Bip1o_TA.js";import{ah as y,aS as w,bR as v,an as C,bn as M,bG as S,ca as k,b5 as P}from"./ui-vendor-DgaPPGCl.js";import"./adminPricingManager-Fd3awkha.js";function E({onClose:s}){const[n,m]=i.useState(N),[c,o]=i.useState(!1),x=(t,r)=>{m(n.map(d=>d.id===t?{...d,price:r}:d)),o(!0)},g=()=>{console.log("Saving extras pricing:",n),alert("Extra items pricing updated!"),o(!1),s()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[90vh] animate-in slide-in-from-bottom-4 duration-300",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 flex items-center justify-between bg-slate-50",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Extra Items Pricing"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Configure standard prices for extra services"})]}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-slate-200 rounded-full transition-colors",children:e.jsx(y,{className:"w-5 h-5 text-slate-500"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto flex-1 custom-scrollbar",children:e.jsx("div",{className:"space-y-4",children:n.map(t=>e.jsxs("div",{className:"flex items-center gap-4 p-4 border border-slate-200 rounded-xl hover:border-purple-200 hover:bg-purple-50/30 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:t.name}),e.jsxs("div",{className:"text-xs text-slate-500 capitalize",children:[t.type==="per_floor"?"Per Flight of Stairs":t.type==="flat"?"Flat Fee":t.type.replace("_"," ")," Charge"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(w,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"number",value:t.price,onChange:r=>x(t.id,parseFloat(r.target.value)||0),className:"w-24 pl-9 pr-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-200 outline-none font-medium text-slate-900",min:"0"})]})})]},t.id))})}),e.jsxs("div",{className:"p-6 border-t border-slate-200 bg-slate-50 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-slate-600 font-medium hover:bg-slate-200 rounded-lg transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:g,disabled:!c,className:`px-6 py-2 rounded-lg font-bold flex items-center gap-2 transition-all ${c?"bg-purple-600 text-white hover:bg-purple-700 shadow-lg":"bg-slate-200 text-slate-400 cursor-not-allowed"}`,children:[e.jsx(v,{className:"w-4 h-4"}),"Save Changes"]})]})]})})}const f={type:"percentage",percentageMargin:30,fixedMargin:15,minimumMargin:10,useDriverRateCards:!0};function T(){const[s,n]=i.useState(f),[m,c]=i.useState(f),[o,x]=i.useState(!1),[g,t]=i.useState(!1),r=(a,h)=>{const b={...s,[a]:h};n(b),x(JSON.stringify(b)!==JSON.stringify(m))},d=()=>{c(s),x(!1),alert("Margin configuration saved successfully! ✅")},l=150,u=(()=>{if(s.type==="percentage"){const a=l*s.percentageMargin/100;return Math.max(l-a,0)}else{if(s.type==="fixed")return Math.max(l-s.fixedMargin,0);{const a=l*s.percentageMargin/100,h=Math.max(a,s.fixedMargin,s.minimumMargin);return Math.max(l-h,0)}}})(),p=l-u,j=p/l*100;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-slate-900",children:"Margin Configuration"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Configure automatic driver/partner pricing"})]}),e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-xl hover:from-purple-700 hover:to-blue-700 transition-all shadow-lg",children:[e.jsx(C,{className:"w-5 h-5"}),"Extra Items Pricing"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-slate-200 p-6",children:[e.jsxs("h3",{className:"font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5 text-blue-600"}),"Rate Card Source"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[e.jsx("input",{type:"checkbox",id:"useDriverRateCards",checked:s.useDriverRateCards,onChange:a=>r("useDriverRateCards",a.target.checked),className:"mt-1 w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("label",{htmlFor:"useDriverRateCards",className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Use Separate Driver Rate Cards"}),e.jsx("div",{className:"text-sm text-slate-600 mt-1",children:"If enabled, driver pricing will be calculated from separate driver rate cards. If disabled, driver price will be calculated from customer price minus margin."})]})]}),!s.useDriverRateCards&&e.jsxs("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-xl flex items-start gap-2",children:[e.jsx(S,{className:"w-5 h-5 text-orange-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-orange-700",children:[e.jsx("strong",{children:"Note:"})," Driver pricing will be calculated using the margin configuration below."]})]})]})]}),!s.useDriverRateCards&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-slate-200 p-6",children:[e.jsxs("h3",{className:"font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5 text-purple-600"}),"Margin Type"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{onClick:()=>r("type","percentage"),className:`p-4 border-2 rounded-xl cursor-pointer transition-all ${s.type==="percentage"?"border-purple-500 bg-purple-50":"border-slate-200 hover:border-purple-300 bg-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${s.type==="percentage"?"border-purple-600":"border-slate-300"}`,children:s.type==="percentage"&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-purple-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Percentage Margin"}),e.jsx("div",{className:"text-sm text-slate-600",children:"Platform takes a percentage of the customer price"})]})]}),s.type==="percentage"&&e.jsxs("div",{className:"mt-4 pl-8",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Percentage Margin (%)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",value:s.percentageMargin,onChange:a=>r("percentageMargin",parseFloat(a.target.value)||0),className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-200 outline-none",min:"0",max:"100",step:"0.5"}),e.jsx("span",{className:"text-slate-700 font-semibold",children:"%"})]}),e.jsx("div",{className:"text-xs text-slate-500 mt-2",children:"Example: 20% margin on £150 = £30 platform fee, £120 driver earnings"})]})]}),e.jsxs("div",{onClick:()=>r("type","fixed"),className:`p-4 border-2 rounded-xl cursor-pointer transition-all ${s.type==="fixed"?"border-green-500 bg-green-50":"border-slate-200 hover:border-green-300 bg-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${s.type==="fixed"?"border-green-600":"border-slate-300"}`,children:s.type==="fixed"&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Fixed Margin"}),e.jsx("div",{className:"text-sm text-slate-600",children:"Platform takes a fixed amount per job"})]})]}),s.type==="fixed"&&e.jsxs("div",{className:"mt-4 pl-8",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Fixed Margin (£)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-700 font-semibold",children:"£"}),e.jsx("input",{type:"number",value:s.fixedMargin,onChange:a=>r("fixedMargin",parseFloat(a.target.value)||0),className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-200 outline-none",min:"0",step:"0.5"})]}),e.jsx("div",{className:"text-xs text-slate-500 mt-2",children:"Example: £15 margin on £150 = £15 platform fee, £135 driver earnings"})]})]}),e.jsxs("div",{onClick:()=>r("type","hybrid"),className:`p-4 border-2 rounded-xl cursor-pointer transition-all ${s.type==="hybrid"?"border-blue-500 bg-blue-50":"border-slate-200 hover:border-blue-300 bg-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${s.type==="hybrid"?"border-blue-600":"border-slate-300"}`,children:s.type==="hybrid"&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Hybrid (% + Minimum)"}),e.jsx("div",{className:"text-sm text-slate-600",children:"Use whichever margin is higher"})]})]}),s.type==="hybrid"&&e.jsxs("div",{className:"mt-4 pl-8 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Percentage Margin (%)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",value:s.percentageMargin,onChange:a=>r("percentageMargin",parseFloat(a.target.value)||0),className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-200 outline-none",min:"0",max:"100",step:"0.5"}),e.jsx("span",{className:"text-slate-700 font-semibold",children:"%"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Minimum Margin (£)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-700 font-semibold",children:"£"}),e.jsx("input",{type:"number",value:s.minimumMargin,onChange:a=>r("minimumMargin",parseFloat(a.target.value)||0),className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-200 outline-none",min:"0",step:"0.5"})]})]}),e.jsx("div",{className:"text-xs text-slate-500",children:"Example: 20% or min £10, whichever is higher"})]})]})]})]}),o&&e.jsxs("button",{onClick:d,className:"w-full py-4 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-xl font-bold hover:from-green-700 hover:to-emerald-700 transition-all shadow-lg flex items-center justify-center gap-2",children:[e.jsx(v,{className:"w-5 h-5"}),"Save Configuration"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl shadow-lg border border-blue-200 p-6",children:[e.jsxs("h3",{className:"font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5 text-blue-600"}),"Live Example"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-slate-600 mb-1",children:"Customer Price"}),e.jsxs("div",{className:"text-2xl font-bold text-slate-900",children:["£",l.toFixed(2)]})]}),e.jsx("div",{className:"h-px bg-slate-300"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-slate-600 mb-1",children:"Platform Margin"}),e.jsxs("div",{className:"text-xl font-bold text-purple-600",children:["£",p.toFixed(2)," (",j.toFixed(1),"%)"]})]}),e.jsx("div",{className:"h-px bg-slate-300"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-slate-600 mb-1",children:"Driver Earnings"}),e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["£",u.toFixed(2)]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-slate-200 p-6",children:[e.jsx("h3",{className:"font-bold text-slate-900 mb-3",children:"How it works"}),e.jsxs("div",{className:"space-y-3 text-sm text-slate-700",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0 text-blue-600 font-bold text-xs",children:"1"}),e.jsx("div",{children:"Customer booking is calculated using customer rate cards"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0 text-blue-600 font-bold text-xs",children:"2"}),e.jsx("div",{children:"Driver price is calculated automatically based on your configuration"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0 text-blue-600 font-bold text-xs",children:"3"}),e.jsx("div",{children:"Admin sees both prices, driver sees only driver price"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0 text-blue-600 font-bold text-xs",children:"4"}),e.jsx("div",{children:"Platform margin is calculated automatically"})]})]})]})]})]}),g&&e.jsx(E,{onClose:()=>t(!1)})]})}export{T as MarginConfiguration};
